"use strict";!function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var h="function"==typeof require&&require;if(!a&&h)return h(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return r(n?n:t)},l,l.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,e,n){var i=function(){function t(){this.draw=function(t){M.fillStyle=t,M.beginPath(),M.arc(this.x,this.y,this.radius,0,2*Math.PI,!0),M.closePath(),M.fill()}}function e(t,e,n){this.x=t,this.y=e,this.colonyId=n,this.phi=(2*Math.random()-1)*Math.PI,this.food=0,this.nearbyObjects=[]}function n(t,e,n,i){this.x=t,this.y=e,this.foodTheta=n,this.scent=i}function i(){this.allXYObjects=[],this.getAllXYObjects=function(){this.allXYObjects.splice(0,this.allXYObjects.length),this.allXYObjects=this.scentMap.concat(y);for(var t=0;t<b.length;t++)this.allXYObjects=this.allXYObjects.concat(b[t].workers,b[t].queen)},this.getInteractions=function(){function t(t,e,n){var i=t.x-e.x;if(n>i&&i>-n){var r=t.y-e.y,o=Math.sqrt(Math.pow(i,2)+Math.pow(r,2));if(n>o)return!0}return!1}function n(n,i){if(s=d.allXYObjects[n],!(s.constructor===e&&s.colonyId===i.colonyId||s.constructor===r&&s.colonyId!==i.colonyId)){if(!t(i,s,i.senseDist))return!0;i.nearbyObjects.push(s)}return!1}var i,o,s;this.allXYObjects.sort(function(t,e){return t.x-e.x});for(var a=0;a<this.allXYObjects.length;a++)if(o=d.allXYObjects[a],o.constructor===e){for(i=a;--i>=0&&n(i,o););for(i=a;++i<d.allXYObjects.length&&n(i,o););}},this.scentMap=[],this.scentMapSize=1024,this.scentMapMinScent=.1,this.createScent=function(t,e,i,r){function o(t){var e=2*n.prototype.radius;return(t/e).toFixed(0)*e}d.scentMap.push(new n(o(t),o(e),i,r))},this.degradeScentMap=function(){for(var t=this.scentMap.length,e=t-this.scentMapSize;t--;)this.scentMap[t].scent*=.995;this.scentMap.sort(function(t,e){return e.scent-t.scent});var n=this.scentMap.map(function(t){return t.scent<d.scentMapMinScent?!0:void 0}).indexOf(!0);this.scentMap.splice(n,this.scentMap.length-n),e>0&&this.scentMap.splice(this.scentMapSize,e)},this.drawScentMap=function(){for(var t=0;t<d.scentMap.length;t++)this.scentMap[t].draw(this.scentMap[t].color())}}function r(t,e,n){this.x=t,this.y=e,this.energy=3,this.colonyId=n}function o(t){this.workers=[],this.queen=new r(Math.random()*(w.width-2*r.prototype.radius)+r.prototype.radius,Math.random()*(w.height-2*r.prototype.radius)+r.prototype.radius,t),this.colonyId=t,this.color="rgb("+(255*this.colonyId/(f-1)).toFixed(0)+", 0, 0)"}function s(t,e,n){this.x=t,this.y=e,this.feederId=n,this.energy=128}function a(){if(g){window.requestAnimFrame(a),d.getAllXYObjects(),d.getInteractions();for(var t=0;t<b.length;t++)for(var e=0;e<b[t].workers.length;e++)b[t].workers[e].dead?(b[t].workers.splice(e,1),0===b[t].workers.length&&(b[t].dead=!0,y.pop())):b[t].workers[e].decide();c()}}function h(){var t=document.createElement("div");t.className="center",t.appendChild(I),t.appendChild(k),v.appendChild(q),v.appendChild(t),v.appendChild(w),document.body.appendChild(v)}function c(){var t;for(M.fillStyle="rgba(255, 255, 255, "+x+")",M.fillRect(0,0,w.width,w.height),d.degradeScentMap(),O&&d.drawScentMap(),t=0;t<b.length;t++)b[t].dead||b[t].queen.draw(b[t].color);for(t=0;t<y.length;t++)y[t].draw(y[t].color);for(t=0;t<b.length;t++)for(var e=0;e<b[t].workers.length;e++)b[t].workers[e].draw(b[t].color);if(M.font="10px Calibri",j){var n=0,i=0;for(t=0;t<b.length;t++)b[t].dead||(n+=b[t].workers.length,M.fillStyle=b[t].color,M.fillText("colonyId "+t+": "+b[t].workers.length,0,10*i+10),i++);M.fillStyle="blue",M.fillText("Total Worker Ants: "+n,0,10*i+10),M.fillText("Scent Map Size: "+d.scentMap.length,0,10*(i+1)+10)}}function l(t,e){var n=t.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}}function p(){h(),g=!0,a()}function u(){g=!1,v.parentNode&&v.parentNode.removeChild(v)}var d,f=48,y=[],b=[],w=document.createElement("canvas");w.width=640,w.height=w.width;var M=w.getContext("2d");e.prototype=new t,e.prototype.constructor=e,e.prototype.maxV=2,e.prototype.dead=!1,e.prototype.radius=1.2,e.prototype.senseDist=16*e.prototype.radius,e.prototype.decide=function(){function t(t,e,n){for(var i,r=this.nearbyObjects.length,o=this.senseDist+1;r--;)this.nearbyObjects[r].constructor===t&&Math.sqrt(Math.pow(this.nearbyObjects[r].x-this.x,2)+Math.pow(this.nearbyObjects[r].y-this.y,2))<o&&(i=r,o=Math.sqrt(Math.pow(this.nearbyObjects[r].x-this.x,2)+Math.pow(this.nearbyObjects[r].y-this.y,2)));return e>=o?(n.call(this,i),!0):void 0}if(0===this.food){if(t.call(this,e,2*this.radius,function(t){this.attack(this.nearbyObjects[t]),this.nearbyObjects.splice(0,this.nearbyObjects.length)}))return;if(t.call(this,s,s.prototype.radius+this.radius,function(t){this.food=1,this.nearbyObjects[t].feed(),this.nearbyObjects.splice(0,this.nearbyObjects.length)}))return;if(t.call(this,s,this.senseDist,function(t){this.phi=Math.atan2(this.nearbyObjects[t].y-this.y,this.nearbyObjects[t].x-this.x+Math.PI/2),this.movePolar(),this.nearbyObjects.splice(0,this.nearbyObjects.length)}))return;this.borderControl()||t.call(this,n,n.prototype.radius,function(t){this.phi=this.nearbyObjects[t].foodTheta+Math.PI/2})}else 1===this.food&&(t.call(this,r,r.prototype.radius,function(t){this.food=0,this.nearbyObjects[t].feed(),this.phi+=Math.PI,this.nearbyObjects.splice(0,this.nearbyObjects.length)})||(this.phi=Math.atan2(b[this.colonyId].queen.y-this.y,b[this.colonyId].queen.x-this.x+Math.PI/2),t.call(this,n,n.prototype.radius,function(t){this.nearbyObjects[t].foodTheta=this.phi-1.5*Math.PI,this.nearbyObjects[t].scent+=1})||d.createScent(this.x,this.y,this.phi-1.5*Math.PI,1)));this.movePolar(),this.nearbyObjects.splice(0,this.nearbyObjects.length)},e.prototype.movePolar=function(){var t=.1;this.phi+=2*(.5-Math.random())*t,this.x+=this.maxV*Math.cos(this.phi),this.y+=this.maxV*Math.sin(this.phi)},e.prototype.borderControl=function(){function t(t){return this.phi=-this.phi+t,this.movePolar(),!0}var e=this.radius+this.maxV;return this.x-e<=0?Math.cos(this.phi)<0&&t.call(this,Math.PI):this.x+e>=w.width?Math.cos(this.phi)>0&&t.call(this,Math.PI):this.y-e<=0?Math.sin(this.phi)<0&&t.call(this,0):this.y+e>=w.height&&Math.sin(this.phi)>0&&t.call(this,0),!1},e.prototype.attack=function(t){t.dead=!0},n.prototype=new t,n.prototype.constructor=n,n.prototype.radius=3*e.prototype.radius,n.prototype.color=function(){return"rgb(127, 255, 255)"},d=new i,r.prototype=new t,r.prototype.radius=2*e.prototype.radius,r.prototype.constructor=r,r.prototype.feed=function(){this.energy+=1,this.spawn(this.colonyId)},r.prototype.spawn=function(t){for(var n=3;this.energy>=n;)this.energy-=n,b[t].workers.push(new e(this.x,this.y,this.colonyId))};var m=0;s.prototype=new t,s.prototype.color="#7777FF",s.prototype.radius=3*e.prototype.radius,s.prototype.constructor=s,s.prototype.feed=function(){this.energy-=1,this.energy<=0&&(y.push(new s(Math.random()*(w.width-2*s.prototype.radius)+s.prototype.radius,Math.random()*(w.height-2*s.prototype.radius)+s.prototype.radius,m)),y.splice(y.indexOf(this),1))},function(){var t,e=f-1;for(t=0;e>t;t++)y[t]=new s(Math.random()*(w.width-2*s.prototype.radius)+s.prototype.radius,Math.random()*(w.height-2*s.prototype.radius)+s.prototype.radius,t);for(t=0;f>t;t++)b[t]=new o(t),b[t].queen.spawn(t)}();var g=!0,v=document.createElement("div");!function(){var t=function(t){var e=function n(e){return e.length>=t.length?t.apply(null,e):function(){return n(e.concat(Array.prototype.slice.apply(arguments)))}};return e(Array.prototype.slice.apply(arguments,[1]))},e=function(t,e,n){var i=document.createElement(e);i.appendChild(document.createTextNode(n)),t.appendChild(i)},n=t(e),i=n(v),r=i("h1"),o=i("h3"),s=i("p");r("Antdemic"),o("About"),s("Each worker ant has a very limited sense distance and finds food using scent trails laid down by other worker ants. Worker ants instinctively know their way back to their queen and feed her. As the queen feeds she spawns new workers. Each feeder has a limited food supply and when it is used up a new feeder is spawned in a new location. Worker ants will attack worker ants from other colonies if they come into contact. If a colony loses all its ants the queen will perish and the number of feeders on the canvas is reduced."),o("Controls"),s("Left click on the canvas to add a feeder and right click on a feeder to remove it.")}();var x=.17;window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();var O=!1,j=!0,k=document.createElement("button"),I=document.createElement("button"),q=document.createElement("label");q.innerHTML="Adjust Motion Blur Effect";var S=document.createElement("input");return S.setAttribute("type","range"),S.setAttribute("min","1"),S.setAttribute("max","16"),S.setAttribute("step","1"),S.setAttribute("value",1/x),S.onchange=function(){x=1/this.value},k.onfocus=function(){this.blur&&this.blur()},I.onfocus=function(){this.blur&&this.blur()},q.appendChild(S),k.innerHTML="Show / Hide Scent Map",I.innerHTML="Show / Hide Stats",k.onclick=function(){O=!O},I.onclick=function(){j=!j},w.addEventListener("contextmenu",function(t){t.preventDefault();for(var e=l(w,t),n=y.length;n--;)e.x>y[n].x-y[n].radius&&e.x<y[n].x+y[n].radius&&e.y>y[n].y-y[n].radius&&e.y<y[n].y+y[n].radius&&y.splice(n,1)},!1),w.addEventListener("click",function(t){var e=l(w,t);0===t.button&&(y[y.length]=new s(e.x,e.y))},!1),{on:p,off:u}}();i.on()},{}]},{},[1]);